APP_NAME=Laravel
APP_ENV=local
APP_KEY=
APP_DEBUG=true
APP_URL=http://localhost

APP_LOCALE=en
APP_FALLBACK_LOCALE=en
APP_FAKER_LOCALE=en_US

APP_MAINTENANCE_DRIVER=file
# APP_MAINTENANCE_STORE=database

# PHP_CLI_SERVER_WORKERS=4

BCRYPT_ROUNDS=12

LOG_CHANNEL=stack
# Channels: single, daily, grafana (Grafana/Loki), sentry_logs (auto-added when SENTRY_ENABLE_LOGS=true)
LOG_STACK=single
LOG_DEPRECATIONS_CHANNEL=null
LOG_LEVEL=debug

DB_CONNECTION=sqlite
# DB_HOST=127.0.0.1
# DB_PORT=3306
# DB_DATABASE=laravel
# DB_USERNAME=root
# DB_PASSWORD=

SESSION_DRIVER=database
SESSION_LIFETIME=120
SESSION_ENCRYPT=false
SESSION_PATH=/
SESSION_DOMAIN=null

BROADCAST_CONNECTION=reverb
FILESYSTEM_DISK=local
# Media (evidence, dashcam, logos): public = local storage; s3 = MinIO/S3 (persists in Sail via sail-minio-data)
MEDIA_DISK=public
QUEUE_CONNECTION=database

CACHE_STORE=database
# CACHE_PREFIX=

MEMCACHED_HOST=127.0.0.1

REDIS_CLIENT=phpredis
REDIS_HOST=127.0.0.1
REDIS_PASSWORD=null
REDIS_PORT=6379

MAIL_MAILER=log
MAIL_SCHEME=null
MAIL_HOST=127.0.0.1
MAIL_PORT=2525
MAIL_USERNAME=null
MAIL_PASSWORD=null
MAIL_FROM_ADDRESS="hello@example.com"
MAIL_FROM_NAME="${APP_NAME}"

# S3-compatible storage (MinIO in dev). For Sail: endpoint uses container name "minio".
# To persist evidence/dashcam images in MinIO in dev: set MEDIA_DISK=s3.
# The bucket sam-media is created and set to public read on sail up (minio-sam-media-init).
AWS_ACCESS_KEY_ID=${MINIO_ROOT_USER:-minio}
AWS_SECRET_ACCESS_KEY=${MINIO_ROOT_PASSWORD:-miniosecret}
AWS_DEFAULT_REGION=us-east-1
AWS_BUCKET=sam-media
AWS_ENDPOINT=http://minio:9000
# URL for public links (browser); Sail maps MinIO to host port 9090
AWS_URL=http://localhost:9090/sam-media
AWS_USE_PATH_STYLE_ENDPOINT=true

VITE_APP_NAME="${APP_NAME}"

# ============================================================================
# SAM - AI Service (alert pipeline)
# ============================================================================
# Official ingest: POST /alerts/ingest. Laravel uses config('services.ai_engine.url').
AI_SERVICE_BASE_URL=http://ai-service:8000

# ============================================================================
# SAM - Webhook simulator (solo dev, alerts:replay)
# ============================================================================
# Permitir replay en no-local (por defecto solo APP_ENV=local)
# WEBHOOK_SIMULATOR_ENABLED=false
# URL del backend al que enviar el webhook (desde dentro de Sail usar laravel.test)
# WEBHOOK_SIMULATOR_TARGET_URL=

# ============================================================================
# LANGFUSE OBSERVABILITY (Self-Hosted)
# ============================================================================
# Langfuse Web UI URL
LANGFUSE_URL=http://localhost:3030

# Security Keys (CHANGE THESE IN PRODUCTION!)
# Generate NEXTAUTH_SECRET: openssl rand -hex 32
# Generate ENCRYPTION_KEY: openssl rand -hex 32
LANGFUSE_NEXTAUTH_SECRET=changeme-generate-via-openssl-rand-hex-32
LANGFUSE_SALT=changeme-mysalt
LANGFUSE_ENCRYPTION_KEY=0000000000000000000000000000000000000000000000000000000000000000

# ClickHouse Database
CLICKHOUSE_USER=clickhouse
CLICKHOUSE_PASSWORD=clickhouse

# MinIO Object Storage
MINIO_ROOT_USER=minio
MINIO_ROOT_PASSWORD=miniosecret

# Optional: Auto-create initial user/org/project on first startup
LANGFUSE_INIT_USER_EMAIL=
LANGFUSE_INIT_USER_PASSWORD=
LANGFUSE_INIT_USER_NAME=
LANGFUSE_INIT_ORG_NAME=
LANGFUSE_INIT_PROJECT_NAME=

# Telemetry (set to false to disable)
LANGFUSE_TELEMETRY_ENABLED=true

# ============================================================================
# LARAVEL PULSE - Application Monitoring
# ============================================================================
PULSE_ENABLED=true

# Storage configuration
PULSE_STORAGE_KEEP="14 days"
PULSE_DB_CONNECTION=pgsql

# Ingest configuration (use redis for high-performance)
PULSE_INGEST_DRIVER=redis
PULSE_REDIS_CONNECTION=default
PULSE_CACHE_DRIVER=redis

# Server monitoring
PULSE_SERVER_NAME=sam-app
PULSE_SERVER_DIRECTORIES=/

# Sampling rates (1 = 100%, 0.1 = 10%)
PULSE_CACHE_INTERACTIONS_SAMPLE_RATE=1
PULSE_EXCEPTIONS_SAMPLE_RATE=1
PULSE_QUEUES_SAMPLE_RATE=1
PULSE_SLOW_JOBS_SAMPLE_RATE=1
PULSE_SLOW_OUTGOING_REQUESTS_SAMPLE_RATE=1
PULSE_SLOW_QUERIES_SAMPLE_RATE=1
PULSE_SLOW_REQUESTS_SAMPLE_RATE=1
PULSE_USER_JOBS_SAMPLE_RATE=1
PULSE_USER_REQUESTS_SAMPLE_RATE=1

# Thresholds (in milliseconds)
PULSE_SLOW_JOBS_THRESHOLD=1000
PULSE_SLOW_OUTGOING_REQUESTS_THRESHOLD=1000
PULSE_SLOW_QUERIES_THRESHOLD=500
PULSE_SLOW_REQUESTS_THRESHOLD=1000

# SAM Custom Recorders
PULSE_ALERT_PROCESSING_ENABLED=true
PULSE_TOKEN_USAGE_ENABLED=true
PULSE_NOTIFICATION_ENABLED=true
PULSE_AI_SERVICE_ENABLED=true
PULSE_COPILOT_ENABLED=true
PULSE_WEBSOCKET_ENABLED=true

# ============================================================================
# LARAVEL REVERB - WebSocket Server
# ============================================================================
# App credentials (must match between server and client)
REVERB_APP_ID=sam
REVERB_APP_KEY=sam-local-key
REVERB_APP_SECRET=sam-local-secret

# Client/browser connection settings (external hostname for WebSocket client)
REVERB_HOST="localhost"
REVERB_PORT=8080
REVERB_SCHEME=http

# Server-to-server connection (Docker internal - used by Laravel to broadcast)
# In Docker: use container name "reverb"
# Without Docker: use "localhost" or "127.0.0.1"
REVERB_SERVER_HOST=reverb
REVERB_SERVER_PORT=8080
REVERB_SERVER_SCHEME=http

# Production settings
REVERB_MAX_REQUEST_SIZE=65536
REVERB_APP_MAX_CONNECTIONS=1000
REVERB_APP_MAX_MESSAGE_SIZE=65536

# Horizontal scaling with Redis (enable in production with multiple instances)
REVERB_SCALING_ENABLED=false
REVERB_SCALING_CHANNEL=reverb

# Vite frontend config (exposes to browser at BUILD time)
# Local/dev: references work if your .env has REVERB_* set.
# Production (Dokploy, etc.): set VITE_* with LITERAL values so the built JS
# connects to your real domain (e.g. wss://copilot.delapengineering.com), not localhost.
# Example for production:
#   VITE_REVERB_APP_KEY=9465f84cba80ad73f5976f8022e59f646e8dbbb243fedace43b2368dea4c454e
#   VITE_REVERB_HOST=copilot.delapengineering.com
#   VITE_REVERB_PORT=443
#   VITE_REVERB_SCHEME=https
VITE_REVERB_APP_KEY="${REVERB_APP_KEY}"
VITE_REVERB_HOST="${REVERB_HOST}"
VITE_REVERB_PORT="${REVERB_PORT}"
VITE_REVERB_SCHEME="${REVERB_SCHEME}"

# Usage metering: usage_events + usage_daily_summaries (aggregate via sam:aggregate-usage).
# Pricing/billing is handled in-house; no Stripe/Cashier.

# ============================================================================
# SENTRY - Error Monitoring, Logs, Tracing, Profiling
# ============================================================================
# Dokploy/single .env: define ambos aquí. Laravel y AI Service los leen vía compose.
#
# Opción A - Mismo proyecto Sentry para Laravel + AI Service:
#   SENTRY_LARAVEL_DSN=https://...@o4510918785433600.ingest.us.sentry.io/PROJECT_ID
#   (AI_SENTRY_DSN no hace falta; AI Service hereda SENTRY_LARAVEL_DSN)
#
# Opción B - Dos proyectos Sentry (uno Laravel, otro AI Service):
#   SENTRY_LARAVEL_DSN=https://...@o4510918785433600.ingest.us.sentry.io/LARAVEL_PROJECT_ID
#   AI_SENTRY_DSN=https://...@o4510918785433600.ingest.us.sentry.io/AI_PROJECT_ID
#
SENTRY_LARAVEL_DSN=
# AI_SENTRY_DSN=   # Solo si quieres proyecto separado para AI Service

# Error Monitoring (default: enabled when DSN is set)
SENTRY_SAMPLE_RATE=1.0

# Tracing - Performance monitoring (set to 0 to disable)
SENTRY_TRACES_SAMPLE_RATE=1.0

# Profiling - Requires Excimer extension: pecl install excimer (Linux/macOS only)
SENTRY_PROFILES_SAMPLE_RATE=1.0

# Send logs to Sentry (sentry_logs channel is auto-added to stack when true; can replace Grafana)
SENTRY_ENABLE_LOGS=true
SENTRY_LOG_LEVEL=info
# Comma-separated hosts for distributed tracing (sentry-trace + baggage). Empty = use defaults (ai-service, localhost, 127.0.0.1)
# SENTRY_TRACE_PROPAGATION_TARGETS=ai-service,localhost,127.0.0.1

# Include PII (headers, IP, user) in events - enable only if compliant with your privacy policy
SENTRY_SEND_DEFAULT_PII=false

# Optional: release version (e.g. git hash for deploy tracking)
# SENTRY_RELEASE=
# SENTRY_ENVIRONMENT=

# Optional: for sentry:issues command (list issues via REST API)
# SENTRY_AUTH_TOKEN=   # User Auth Token with event:read, project:read, org:read
# SENTRY_ORG_SLUG=sam-global-technologies
